global
    log 127.0.0.1   syslog info
    daemon
    user vcap
    group vcap
    maxconn 64000
    spread-checks 4

defaults
    log global
    timeout connect 30000ms
    timeout client <%= p("request_timeout_in_seconds").to_i * 1000 %>ms
    timeout server <%= p("request_timeout_in_seconds").to_i * 1000 %>ms

listen mysql-cluster
    bind 0.0.0.0:3306
    mode tcp
    option tcplog
    option mysql-check user <%= p("haproxy_mysql_user") %>
    balance roundrobin
    server mysql-0 <%= p('mysql_node.ip')%>:3306 check

